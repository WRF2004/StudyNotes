### 作业6

> 1. 分析磁盘访问数据的时间。假设磁盘请求以柱面10、35、20、70、2、 3 和 38 的次序进入磁盘驱动器。寻道时磁头每移动一个柱面需要 5ms，以下各算法所需的寻道时间是多少：  
>
>    (1)先来先服务  
>
>    (2)最短寻道时间优先  
>
>    (3)SCAN算法  
>
>    (4)LOOK算法  
>
>    说明：假设以上三种情况磁头初始位置为15。对于（3）和（4）， 磁头 当前向大柱面号方向运行，磁盘最大柱面号为85。

(1) 共移动磁道数 = 5 + 25 + 15 + 50 + 68 + 1 + 35 = 199；寻道时间 = 995ms

(2) 共移动磁道数 = 5 + 7 + 1 + 18 + 15 + 3 + 32 = 81; 寻道时间 = 405ms

(3) 共移动磁道数 = 153; 寻道时间 = 765ms

(4) 共移动磁道数 = 123; 寻道时间 = 615ms



> 2. 在I/O系统中引入缓冲区的主要目标是什么？某文件占8个磁盘块， 现要把该文件的磁盘块逐个读入主存缓冲区，并送用户区进行分析。 一个缓冲区与磁盘块大小相等。把一个磁盘块读入缓冲区的时间为 100μs，缓冲区数据传送到用户区的时间是50μs，CPU对一块数据 进行分析的时间为50μs。分别计算在单缓冲区和双缓冲区结构下， 分析完该文件的时间是多少？

在I/O系统中引入缓冲区的主要目标是: 缓和CPU与I/O设备间速度不匹配的矛盾，减少CPU的中断频率，提高CPU与I/O设备间的并行性；

单缓冲区：t = 150 * 8 = 1200μs

双缓冲区：t = 800μs



> 3. 请结合操作系统课所学习的内容总结从哪些方面可以提高文件系统 的性能。

采用块高速缓存提高文件系统访问性能，优化磁盘调度，合理分配磁盘空间，磁盘碎片整理，设置合适的磁盘块的大小。



> 4. 简述文件控制块（FCB-File Control Block）中所管理的主要信息。

文件控制块主要管理文件的基本信息如：文件名、物理位置、文件逻辑结构、文件物理结构，访问控制信息包括文件所有者和访问权限，使用信息包括文件创建时间。



> 5. 在文件系统中，访问一个文件f时首先需要从目录中找到与f对应 的目录项。假设磁盘物理块的大小为1KB，一个目录项的大小为128 字节，文件的平均大小为100KB。该 文 件 系 统 的 目 录 结 构 如 下图所示。 假定不考虑磁盘块的提前读和缓存等加速磁盘访问技术。请回答以下问题：
>
>    ![微信截图_20240524095647](D:%5CDesktop%5C%E7%85%A7%E7%89%87%5CPictures%5C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%5C%E4%BD%9C%E4%B8%9A6%5C%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20240524095647.png)
>
>    （1） 按照当前的目录结构，且采用串联文件方式对数据块进行组织， 并且根目录的目录项已读入内存中。如果目标文件f 在第三级目录下， 且其对应的第三级目录的目录项可以一次从磁盘读出，访问文件f中的 一个块平均需要访问几次磁盘？
>
>    （2） 如果采用i节点的方法来构建文件目录，假定文件名占14个字 节，i节点的指针占2个字节。如果仅采用直接索引，每个第三级目录下的文件数不超过50个，且根目录的i节点已读入内存，访问第三级目录下的一个文件的一个块平均需要访问几次磁盘？ 
>
>    （3） 假设该文件系统的空间最大容量为16ZB(1ZB=2^70B)。如 果 文 件 的 FCB 中包括512字节的索引区，且允许采用一级索引进行组织，那么该 文件系统支持的最大文件是多少字节？

(1) 访问文件f中的一个块平均需要访问51.5次磁盘。

(2) 

访问二级目录的i节点1次，访问二级目录内容1次，共2次

访问三级目录的内容至少访问磁盘1次，至多访问磁盘2次，平均1.5次。

访问文件需2次。

平均共需要访问磁盘6.5次

(3) 

总磁盘物理块数 = 2 ^ 74 / 2 ^ 10 = 2 ^ 64;

表示磁盘块需要64位，即8字节;

索引区可索引512 / 8 = 64个磁盘块；

一个磁盘物理块可存储 2 ^ 10 / 8 = 128个磁盘块号；

支持的最大文件为64 * 128 * 1KB = 8MB.

